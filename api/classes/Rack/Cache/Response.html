<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
<head>
<title>Rack::Cache::Response</title>
<meta content='text/html; charset=utf8' http-equiv='Content-Type'>
<link href='../../../css/style.css' media='screen' rel='stylesheet' type='text/css'>
<script type='text/javascript'>
  function popupCode(url) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }
  
  function toggleCode(id) {
    var code = document.getElementById(id)
  
    code.style.display = code.style.display != 'block' ? 'block' : 'none'
    return true
  }
  
  // Make codeblocks hidden by default
  document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
</script>
</head>
<body class='page'>
<div class='class' id='wrapper'>
<div class='header'>
<h1 class='name'><span class='type'>class</span>
Rack::Cache::Response
</h1>
<ol class='paths'>
<li>
<a href="../../../files/lib/rack/cache/response_rb.html">lib/rack/cache/response.rb</a>
</li>
</ol>
<div class='parent'>
Superclass:
<strong>Object</strong>
</div>
</div>
<div id='content'>
<div id='text'>
<div id='description'>
<p>Provides access to the response generated by the downstream application. The <code>response</code>, <code>original_response</code>, and <code>entry</code> objects exposed by the Core caching engine are instances of this class.</p>

<p><a href="Response.html"><code>Response</code></a> objects respond to a variety of convenience methods, including those defined in Rack::Response::Helpers, Rack::Cache::Headers, and Rack::Cache::ResponseHeaders.</p>

<p>Note that <a href="Response.html"><code>Rack::Cache::Response</code></a> is not a subclass of Rack::Response and does not perform many of the same initialization and finalization tasks. For example, the body is not slurped during initialization and there are no facilities for generating response output.</p>
</div>
<div id='method-list'>
<h2>Methods</h2>
<h3>Public Class</h3>
<ol>
<li><a href="#method-c-new">new</a></li>
</ol>
<h3>Public Instance</h3>
<ol>
<li><a href="#method-i-age">age</a></li>
<li><a href="#attribute-i-body">body</a></li>
<li><a href="#method-i-cache_control">cache_control</a></li>
<li><a href="#method-i-cache_control-3D">cache_control=</a></li>
<li><a href="#method-i-cacheable-3F">cacheable?</a></li>
<li><a href="#method-i-client_ttl-3D">client_ttl=</a></li>
<li><a href="#method-i-date">date</a></li>
<li><a href="#method-i-etag">etag</a></li>
<li><a href="#method-i-expire-21">expire!</a></li>
<li><a href="#method-i-expires">expires</a></li>
<li><a href="#method-i-fresh-3F">fresh?</a></li>
<li><a href="#attribute-i-headers">headers</a></li>
<li><a href="#method-i-initialize_copy">initialize_copy</a></li>
<li><a href="#method-i-last_modified">last_modified</a></li>
<li><a href="#method-i-max_age">max_age</a></li>
<li><a href="#method-i-max_age-3D">max_age=</a></li>
<li><a href="#method-i-must_revalidate-3F">must_revalidate?</a></li>
<li><a href="#method-i-not_modified-21">not_modified!</a></li>
<li><a href="#attribute-i-now">now</a></li>
<li><a href="#method-i-private-3D">private=</a></li>
<li><a href="#method-i-reverse_max_age-3D">reverse_max_age=</a></li>
<li><a href="#method-i-shared_max_age-3D">shared_max_age=</a></li>
<li><a href="#attribute-i-status">status</a></li>
<li><a href="#method-i-to_a">to_a</a></li>
<li><a href="#method-i-ttl">ttl</a></li>
<li><a href="#method-i-ttl-3D">ttl=</a></li>
<li><a href="#method-i-validateable-3F">validateable?</a></li>
<li><a href="#method-i-vary">vary</a></li>
<li><a href="#method-i-vary-3F">vary?</a></li>
<li><a href="#method-i-vary_header_names">vary_header_names</a></li>
</ol>
</div>
<div id='context'>
<div id='includes'>
<h2>Included modules</h2>
<ol>
<li>Rack::Response::Helpers</li>
</ol>
</div>
</div>
<div id='section'>
<div id='constants-list'>
<h2>Constants</h2>
<div class='name-list'>
<table summary='Constants'>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>CACHEABLE_RESPONSE_CODES</td>
<td>=</td>
<td class='context-item-value'>[
200, # OK
203, # Non-Authoritative Information
300, # Multiple Choices
301, # Moved Permanently
302, # Found
404, # Not Found
410  # Gone
].to_set</td>
<td>&nbsp;</td>
<td class='context-item-desc'>
<p>Status codes of responses that MAY be stored by a cache or used in reply to a subsequent request.</p>

<p><a target="_top" href="http://tools.ietf.org/html/rfc2616#section-13.4">tools.ietf.org/html/rfc2616#section-13.4</a></p>
</td>
</tr>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>NOT_MODIFIED_OMIT_HEADERS</td>
<td>=</td>
<td class='context-item-value'>%w[
allow
content-encoding
content-language
content-length
content-md5
content-type
last-modified
].to_set</td>
<td>&nbsp;</td>
<td class='context-item-desc'>
<p>Headers that MUST NOT be included with 304 Not Modified responses.</p>

<p><a target="_top" href="http://tools.ietf.org/html/rfc2616#section-10.3.5">tools.ietf.org/html/rfc2616#section-10.3.5</a></p>
</td>
</tr>
</table>
</div>
</div>
<div id='attribute-list'>
<h2 class='section-bar'>Attributes</h2>
<div class='name-list'>
<table>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>
<a name='attribute-i-body'>body</a>
</td>
<td class='context-item-value'>[RW]</td>
<td class='context-item-desc'>
<p><a href="../../Rack.html"><code>Rack</code></a> response tuple accessors.</p>
</td>
</tr>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>
<a name='attribute-i-headers'>headers</a>
</td>
<td class='context-item-value'>[RW]</td>
<td class='context-item-desc'>
<p><a href="../../Rack.html"><code>Rack</code></a> response tuple accessors.</p>
</td>
</tr>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>
<a name='attribute-i-now'>now</a>
</td>
<td class='context-item-value'>[R]</td>
<td class='context-item-desc'>
<p>The time when the <a href="Response.html"><code>Response</code></a> object was instantiated.</p>
</td>
</tr>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>
<a name='attribute-i-status'>status</a>
</td>
<td class='context-item-value'>[RW]</td>
<td class='context-item-desc'>
<p><a href="../../Rack.html"><code>Rack</code></a> response tuple accessors.</p>
</td>
</tr>
</table>
</div>
</div>
<div id='methods'>
<h2>Public Class methods</h2>
<div class='method public-class' id='method-method-c-new'>
<a name='method-c-new'></a>
<div class='synopsis'>
<span class='name'>new</span><span class='arguments'>(status, headers, body)</span>

</div>
<div class='description'>

<p>Create a <a href="Response.html"><code>Response</code></a> instance given the response status code, header hash, and body.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-c-new-source&#39;); return false'>
[show source]
</a>
<pre id='method-c-new-source'>   <span class="ruby-comment"># File lib/rack/cache/response.rb</span>
<span class="line-num">32</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">initialize</span>(<span class="ruby-identifier">status</span>, <span class="ruby-identifier">headers</span>, <span class="ruby-identifier">body</span>)
<span class="line-num">33</span>   <span class="ruby-ivar">@status</span> = <span class="ruby-identifier">status</span>.<span class="ruby-identifier">to_i</span>
<span class="line-num">34</span>   <span class="ruby-ivar">@headers</span> = <span class="ruby-constant">Rack</span><span class="ruby-operator">::</span><span class="ruby-constant">Utils</span><span class="ruby-operator">::</span><span class="ruby-constant">HeaderHash</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">headers</span>)
<span class="line-num">35</span>   <span class="ruby-ivar">@body</span> = <span class="ruby-identifier">body</span>
<span class="line-num">36</span>   <span class="ruby-ivar">@now</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
<span class="line-num">37</span>   <span class="ruby-ivar">@headers</span>[<span class="ruby-string">&#39;date&#39;</span>] <span class="ruby-operator">||=</span> <span class="ruby-ivar">@now</span>.<span class="ruby-identifier">httpdate</span>
<span class="line-num">38</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<h2>Public Instance methods</h2>
<div class='method public-instance' id='method-method-i-age'>
<a name='method-i-age'></a>
<div class='synopsis'>
<span class='name'>age</span><span class='arguments'>()</span>

</div>
<div class='description'>

<p>The age of the response.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-age-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-age-source'>    <span class="ruby-comment"># File lib/rack/cache/response.rb</span>
<span class="line-num">152</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">age</span>
<span class="line-num">153</span>   (<span class="ruby-identifier">headers</span>[<span class="ruby-string">&#39;age&#39;</span>] <span class="ruby-operator">||</span>  [(<span class="ruby-identifier">now</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">date</span>).<span class="ruby-identifier">to_i</span>, <span class="ruby-value">0</span>].<span class="ruby-identifier">max</span>).<span class="ruby-identifier">to_i</span>
<span class="line-num">154</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-cache_control'>
<a name='method-i-cache_control'></a>
<div class='synopsis'>
<span class='name'>cache_control</span><span class='arguments'>()</span>

</div>
<div class='description'>

<p>A Hash of name=value pairs that correspond to the cache-control header. Valueless parameters (e.g., must-revalidate, no-store) have a Hash value of true. This method always returns a Hash, empty if no cache-control header is present.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-cache_control-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-cache_control-source'>   <span class="ruby-comment"># File lib/rack/cache/response.rb</span>
<span class="line-num">69</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">cache_control</span>
<span class="line-num">70</span>   <span class="ruby-ivar">@cache_control</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">CacheControl</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">headers</span>[<span class="ruby-string">&#39;cache-control&#39;</span>])
<span class="line-num">71</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-cache_control-3D'>
<a name='method-i-cache_control-3D'></a>
<div class='synopsis'>
<span class='name'>cache_control=</span><span class='arguments'>(value)</span>

</div>
<div class='description'>

<p>Set the cache-control header to the values specified by the Hash. See the <a href="Response.html#method-i-cache_control"><code>cache_control</code></a> method for information on expected Hash structure.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-cache_control-3D-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-cache_control-3D-source'>   <span class="ruby-comment"># File lib/rack/cache/response.rb</span>
<span class="line-num">75</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">cache_control=</span>(<span class="ruby-identifier">value</span>)
<span class="line-num">76</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-value">:to_hash</span>
<span class="line-num">77</span>     <span class="ruby-identifier">cache_control</span>.<span class="ruby-identifier">clear</span>
<span class="line-num">78</span>     <span class="ruby-identifier">cache_control</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">value</span>)
<span class="line-num">79</span>     <span class="ruby-identifier">value</span> = <span class="ruby-identifier">cache_control</span>.<span class="ruby-identifier">to_s</span>
<span class="line-num">80</span>   <span class="ruby-keyword">end</span>
<span class="line-num">81</span> 
<span class="line-num">82</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">empty?</span>
<span class="line-num">83</span>     <span class="ruby-identifier">headers</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-string">&#39;cache-control&#39;</span>)
<span class="line-num">84</span>   <span class="ruby-keyword">else</span>
<span class="line-num">85</span>     <span class="ruby-identifier">headers</span>[<span class="ruby-string">&#39;cache-control&#39;</span>] = <span class="ruby-identifier">value</span>
<span class="line-num">86</span>   <span class="ruby-keyword">end</span>
<span class="line-num">87</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-cacheable-3F'>
<a name='method-i-cacheable-3F'></a>
<div class='synopsis'>
<span class='name'>cacheable?</span><span class='arguments'>()</span>

</div>
<div class='description'>

<p>Determine if the response is worth caching under any circumstance. Responses marked “private” with an explicit cache-control directive are considered uncacheable</p>

<p>Responses with neither a freshness lifetime (expires, max-age) nor cache validator (last-modified, etag) are considered uncacheable.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-cacheable-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-cacheable-3F-source'>    <span class="ruby-comment"># File lib/rack/cache/response.rb</span>
<span class="line-num">103</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">cacheable?</span>
<span class="line-num">104</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-constant">CACHEABLE_RESPONSE_CODES</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">status</span>)
<span class="line-num">105</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">cache_control</span>.<span class="ruby-identifier">no_store?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">cache_control</span>.<span class="ruby-identifier">private?</span>
<span class="line-num">106</span>   <span class="ruby-identifier">validateable?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">fresh?</span>
<span class="line-num">107</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-client_ttl-3D'>
<a name='method-i-client_ttl-3D'></a>
<div class='synopsis'>
<span class='name'>client_ttl=</span><span class='arguments'>(seconds)</span>

</div>
<div class='description'>

<p>Set the response’s time-to-live for private/client caches. This adjusts the cache-control/max-age directive.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-client_ttl-3D-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-client_ttl-3D-source'>    <span class="ruby-comment"># File lib/rack/cache/response.rb</span>
<span class="line-num">209</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">client_ttl=</span>(<span class="ruby-identifier">seconds</span>)
<span class="line-num">210</span>   <span class="ruby-keyword">self</span>.<span class="ruby-identifier">max_age</span> = <span class="ruby-identifier">age</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">seconds</span>
<span class="line-num">211</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-date'>
<a name='method-i-date'></a>
<div class='synopsis'>
<span class='name'>date</span><span class='arguments'>()</span>

</div>
<div class='description'>

<p>The date, as specified by the Date header. When no Date header is present or is unparseable, set the Date header to Time.now and return.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-date-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-date-source'>    <span class="ruby-comment"># File lib/rack/cache/response.rb</span>
<span class="line-num">139</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">date</span>
<span class="line-num">140</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">date</span> = <span class="ruby-identifier">headers</span>[<span class="ruby-string">&#39;date&#39;</span>]
<span class="line-num">141</span>     <span class="ruby-constant">Time</span>.<span class="ruby-identifier">httpdate</span>(<span class="ruby-identifier">date</span>)
<span class="line-num">142</span>   <span class="ruby-keyword">else</span>
<span class="line-num">143</span>     <span class="ruby-identifier">headers</span>[<span class="ruby-string">&#39;date&#39;</span>] = <span class="ruby-identifier">now</span>.<span class="ruby-identifier">httpdate</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">headers</span>.<span class="ruby-identifier">frozen?</span>
<span class="line-num">144</span>     <span class="ruby-identifier">now</span>
<span class="line-num">145</span>   <span class="ruby-keyword">end</span>
<span class="line-num">146</span> <span class="ruby-keyword">rescue</span> <span class="ruby-constant">ArgumentError</span>
<span class="line-num">147</span>   <span class="ruby-identifier">headers</span>[<span class="ruby-string">&#39;date&#39;</span>] = <span class="ruby-identifier">now</span>.<span class="ruby-identifier">httpdate</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">headers</span>.<span class="ruby-identifier">frozen?</span>
<span class="line-num">148</span>   <span class="ruby-identifier">now</span>
<span class="line-num">149</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-etag'>
<a name='method-i-etag'></a>
<div class='synopsis'>
<span class='name'>etag</span><span class='arguments'>()</span>

</div>
<div class='description'>

<p>The literal value of etag HTTP header or nil if no etag is specified.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-etag-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-etag-source'>    <span class="ruby-comment"># File lib/rack/cache/response.rb</span>
<span class="line-num">220</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">etag</span>
<span class="line-num">221</span>   <span class="ruby-identifier">headers</span>[<span class="ruby-string">&#39;etag&#39;</span>]
<span class="line-num">222</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-expire-21'>
<a name='method-i-expire-21'></a>
<div class='synopsis'>
<span class='name'>expire!</span><span class='arguments'>()</span>

</div>
<div class='description'>

<p>Mark the response stale by setting the Age header to be equal to the maximum age of the response.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-expire-21-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-expire-21-source'>    <span class="ruby-comment"># File lib/rack/cache/response.rb</span>
<span class="line-num">133</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">expire!</span>
<span class="line-num">134</span>   <span class="ruby-identifier">headers</span>[<span class="ruby-string">&#39;age&#39;</span>] = <span class="ruby-identifier">max_age</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">fresh?</span>
<span class="line-num">135</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-expires'>
<a name='method-i-expires'></a>
<div class='synopsis'>
<span class='name'>expires</span><span class='arguments'>()</span>

</div>
<div class='description'>

<p>The value of the expires header as a Time object.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-expires-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-expires-source'>    <span class="ruby-comment"># File lib/rack/cache/response.rb</span>
<span class="line-num">169</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">expires</span>
<span class="line-num">170</span>   <span class="ruby-identifier">headers</span>[<span class="ruby-string">&#39;expires&#39;</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">httpdate</span>(<span class="ruby-identifier">headers</span>[<span class="ruby-string">&#39;expires&#39;</span>])
<span class="line-num">171</span> <span class="ruby-keyword">rescue</span> <span class="ruby-constant">ArgumentError</span>
<span class="line-num">172</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">173</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-fresh-3F'>
<a name='method-i-fresh-3F'></a>
<div class='synopsis'>
<span class='name'>fresh?</span><span class='arguments'>()</span>

</div>
<div class='description'>

<p>Determine if the response is “fresh”. Fresh responses may be served from cache without any interaction with the origin. A response is considered fresh when it includes a cache-control/max-age indicator or Expiration header and the calculated age is less than the freshness lifetime.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-fresh-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-fresh-3F-source'>   <span class="ruby-comment"># File lib/rack/cache/response.rb</span>
<span class="line-num">93</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">fresh?</span>
<span class="line-num">94</span>   <span class="ruby-identifier">ttl</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">ttl</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
<span class="line-num">95</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-initialize_copy'>
<a name='method-i-initialize_copy'></a>
<div class='synopsis'>
<span class='name'>initialize_copy</span><span class='arguments'>(other)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-initialize_copy-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-initialize_copy-source'>   <span class="ruby-comment"># File lib/rack/cache/response.rb</span>
<span class="line-num">40</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">initialize_copy</span>(<span class="ruby-identifier">other</span>)
<span class="line-num">41</span>   <span class="ruby-keyword">super</span>
<span class="line-num">42</span>   <span class="ruby-ivar">@headers</span> = <span class="ruby-identifier">other</span>.<span class="ruby-identifier">headers</span>.<span class="ruby-identifier">dup</span>
<span class="line-num">43</span>   <span class="ruby-ivar">@cache_control</span> = <span class="ruby-keyword">nil</span>
<span class="line-num">44</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-last_modified'>
<a name='method-i-last_modified'></a>
<div class='synopsis'>
<span class='name'>last_modified</span><span class='arguments'>()</span>

</div>
<div class='description'>

<p>The String value of the last-modified header exactly as it appears in the response (i.e., no date parsing / conversion is performed).</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-last_modified-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-last_modified-source'>    <span class="ruby-comment"># File lib/rack/cache/response.rb</span>
<span class="line-num">215</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">last_modified</span>
<span class="line-num">216</span>   <span class="ruby-identifier">headers</span>[<span class="ruby-string">&#39;last-modified&#39;</span>]
<span class="line-num">217</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-max_age'>
<a name='method-i-max_age'></a>
<div class='synopsis'>
<span class='name'>max_age</span><span class='arguments'>()</span>

</div>
<div class='description'>

<p>The number of seconds after the time specified in the response’s Date header when the the response should no longer be considered fresh. First check for a r-maxage directive, then a s-maxage directive, then a max-age directive, and then fall back on an expires header; return nil when no maximum age can be established.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-max_age-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-max_age-source'>    <span class="ruby-comment"># File lib/rack/cache/response.rb</span>
<span class="line-num">161</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">max_age</span>
<span class="line-num">162</span>   <span class="ruby-identifier">cache_control</span>.<span class="ruby-identifier">reverse_max_age</span> <span class="ruby-operator">||</span>
<span class="line-num">163</span>     <span class="ruby-identifier">cache_control</span>.<span class="ruby-identifier">shared_max_age</span> <span class="ruby-operator">||</span>
<span class="line-num">164</span>       <span class="ruby-identifier">cache_control</span>.<span class="ruby-identifier">max_age</span> <span class="ruby-operator">||</span>
<span class="line-num">165</span>        (<span class="ruby-identifier">expires</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">expires</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">date</span>))
<span class="line-num">166</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-max_age-3D'>
<a name='method-i-max_age-3D'></a>
<div class='synopsis'>
<span class='name'>max_age=</span><span class='arguments'>(value)</span>

</div>
<div class='description'>

<p>The number of seconds after which the response should no longer be considered fresh. Sets the cache-control max-age directive.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-max_age-3D-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-max_age-3D-source'>    <span class="ruby-comment"># File lib/rack/cache/response.rb</span>
<span class="line-num">177</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">max_age=</span>(<span class="ruby-identifier">value</span>)
<span class="line-num">178</span>   <span class="ruby-keyword">self</span>.<span class="ruby-identifier">cache_control</span> = <span class="ruby-identifier">cache_control</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-string">&#39;max-age&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_s</span>)
<span class="line-num">179</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-must_revalidate-3F'>
<a name='method-i-must_revalidate-3F'></a>
<div class='synopsis'>
<span class='name'>must_revalidate?</span><span class='arguments'>()</span>

</div>
<div class='description'>

<p>Indicates that the cache must not serve a stale response in any circumstance without first revalidating with the origin. When present, the TTL of the response should not be overriden to be greater than the value provided by the origin.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-must_revalidate-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-must_revalidate-3F-source'>    <span class="ruby-comment"># File lib/rack/cache/response.rb</span>
<span class="line-num">127</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">must_revalidate?</span>
<span class="line-num">128</span>   <span class="ruby-identifier">cache_control</span>.<span class="ruby-identifier">must_revalidate</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">cache_control</span>.<span class="ruby-identifier">proxy_revalidate</span>
<span class="line-num">129</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-not_modified-21'>
<a name='method-i-not_modified-21'></a>
<div class='synopsis'>
<span class='name'>not_modified!</span><span class='arguments'>()</span>

</div>
<div class='description'>

<p>Modify the response so that it conforms to the rules defined for ‘304 Not Modified’. This sets the status, removes the body, and discards any headers that MUST NOT be included in 304 responses.</p>

<p><a target="_top" href="http://tools.ietf.org/html/rfc2616#section-10.3.5">tools.ietf.org/html/rfc2616#section-10.3.5</a></p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-not_modified-21-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-not_modified-21-source'>    <span class="ruby-comment"># File lib/rack/cache/response.rb</span>
<span class="line-num">242</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">not_modified!</span>
<span class="line-num">243</span>   <span class="ruby-identifier">body</span>.<span class="ruby-identifier">close</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">body</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:close</span>)
<span class="line-num">244</span>   <span class="ruby-keyword">self</span>.<span class="ruby-identifier">status</span> = <span class="ruby-value">304</span>
<span class="line-num">245</span>   <span class="ruby-keyword">self</span>.<span class="ruby-identifier">body</span> = []
<span class="line-num">246</span>   <span class="ruby-constant">NOT_MODIFIED_OMIT_HEADERS</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span> <span class="ruby-identifier">headers</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">name</span>) }
<span class="line-num">247</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">248</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-private-3D'>
<a name='method-i-private-3D'></a>
<div class='synopsis'>
<span class='name'>private=</span><span class='arguments'>(value)</span>

</div>
<div class='description'>

<p>Mark the response “private”, making it ineligible for serving other clients.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-private-3D-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-private-3D-source'>    <span class="ruby-comment"># File lib/rack/cache/response.rb</span>
<span class="line-num">117</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">private=</span>(<span class="ruby-identifier">value</span>)
<span class="line-num">118</span>   <span class="ruby-identifier">value</span> = <span class="ruby-identifier">value</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">true</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>
<span class="line-num">119</span>   <span class="ruby-keyword">self</span>.<span class="ruby-identifier">cache_control</span> = <span class="ruby-identifier">cache_control</span>.
<span class="line-num">120</span>     <span class="ruby-identifier">merge</span>(<span class="ruby-string">&#39;public&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">value</span>, <span class="ruby-string">&#39;private&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">value</span>)
<span class="line-num">121</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-reverse_max_age-3D'>
<a name='method-i-reverse_max_age-3D'></a>
<div class='synopsis'>
<span class='name'>reverse_max_age=</span><span class='arguments'>(value)</span>

</div>
<div class='description'>

<p>Like <a href="Response.html#method-i-shared_max_age-3D"><code>shared_max_age=</code></a> but sets the r-maxage directive, which applies only to reverse caches.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-reverse_max_age-3D-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-reverse_max_age-3D-source'>    <span class="ruby-comment"># File lib/rack/cache/response.rb</span>
<span class="line-num">189</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">reverse_max_age=</span>(<span class="ruby-identifier">value</span>)
<span class="line-num">190</span>   <span class="ruby-keyword">self</span>.<span class="ruby-identifier">cache_control</span> = <span class="ruby-identifier">cache_control</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-string">&#39;r-maxage&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_s</span>)
<span class="line-num">191</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-shared_max_age-3D'>
<a name='method-i-shared_max_age-3D'></a>
<div class='synopsis'>
<span class='name'>shared_max_age=</span><span class='arguments'>(value)</span>

</div>
<div class='description'>

<p>Like <a href="Response.html#method-i-max_age-3D"><code>max_age=</code></a> but sets the s-maxage directive, which applies only to shared caches.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-shared_max_age-3D-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-shared_max_age-3D-source'>    <span class="ruby-comment"># File lib/rack/cache/response.rb</span>
<span class="line-num">183</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">shared_max_age=</span>(<span class="ruby-identifier">value</span>)
<span class="line-num">184</span>   <span class="ruby-keyword">self</span>.<span class="ruby-identifier">cache_control</span> = <span class="ruby-identifier">cache_control</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-string">&#39;s-maxage&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_s</span>)
<span class="line-num">185</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-to_a'>
<a name='method-i-to_a'></a>
<div class='synopsis'>
<span class='name'>to_a</span><span class='arguments'>()</span>

</div>
<div class='description'>

<p>Return the status, headers, and body in a three-tuple.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-to_a-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-to_a-source'>   <span class="ruby-comment"># File lib/rack/cache/response.rb</span>
<span class="line-num">47</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">to_a</span>
<span class="line-num">48</span>   [<span class="ruby-identifier">status</span>, <span class="ruby-identifier">headers</span>.<span class="ruby-identifier">to_hash</span>, <span class="ruby-identifier">body</span>]
<span class="line-num">49</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-ttl'>
<a name='method-i-ttl'></a>
<div class='synopsis'>
<span class='name'>ttl</span><span class='arguments'>()</span>

</div>
<div class='description'>

<p>The response’s time-to-live in seconds, or nil when no freshness information is present in the response. When the responses <a href="Response.html#method-i-ttl"><code>ttl</code></a> is &lt;= 0, the response may not be served from cache without first revalidating with the origin.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-ttl-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-ttl-source'>    <span class="ruby-comment"># File lib/rack/cache/response.rb</span>
<span class="line-num">197</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">ttl</span>
<span class="line-num">198</span>   <span class="ruby-identifier">max_age</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">age</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">max_age</span>
<span class="line-num">199</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-ttl-3D'>
<a name='method-i-ttl-3D'></a>
<div class='synopsis'>
<span class='name'>ttl=</span><span class='arguments'>(seconds)</span>

</div>
<div class='description'>

<p>Set the response’s time-to-live for shared caches to the specified number of seconds. This adjusts the cache-control/s-maxage directive.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-ttl-3D-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-ttl-3D-source'>    <span class="ruby-comment"># File lib/rack/cache/response.rb</span>
<span class="line-num">203</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">ttl=</span>(<span class="ruby-identifier">seconds</span>)
<span class="line-num">204</span>   <span class="ruby-keyword">self</span>.<span class="ruby-identifier">shared_max_age</span> = <span class="ruby-identifier">age</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">seconds</span>
<span class="line-num">205</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-validateable-3F'>
<a name='method-i-validateable-3F'></a>
<div class='synopsis'>
<span class='name'>validateable?</span><span class='arguments'>()</span>

</div>
<div class='description'>

<p>Determine if the response includes headers that can be used to validate the response with the origin using a conditional GET request.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-validateable-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-validateable-3F-source'>    <span class="ruby-comment"># File lib/rack/cache/response.rb</span>
<span class="line-num">111</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">validateable?</span>
<span class="line-num">112</span>   <span class="ruby-identifier">headers</span>.<span class="ruby-identifier">key?</span>(<span class="ruby-string">&#39;last-modified&#39;</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">headers</span>.<span class="ruby-identifier">key?</span>(<span class="ruby-string">&#39;etag&#39;</span>)
<span class="line-num">113</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-vary'>
<a name='method-i-vary'></a>
<div class='synopsis'>
<span class='name'>vary</span><span class='arguments'>()</span>

</div>
<div class='description'>

<p>The literal value of the vary header, or nil when no header is present.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-vary-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-vary-source'>    <span class="ruby-comment"># File lib/rack/cache/response.rb</span>
<span class="line-num">251</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">vary</span>
<span class="line-num">252</span>   <span class="ruby-identifier">headers</span>[<span class="ruby-string">&#39;vary&#39;</span>]
<span class="line-num">253</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-vary-3F'>
<a name='method-i-vary-3F'></a>
<div class='synopsis'>
<span class='name'>vary?</span><span class='arguments'>()</span>

</div>
<div class='description'>

<p>Does the response include a vary header?</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-vary-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-vary-3F-source'>    <span class="ruby-comment"># File lib/rack/cache/response.rb</span>
<span class="line-num">256</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">vary?</span>
<span class="line-num">257</span>   <span class="ruby-operator">!</span> <span class="ruby-identifier">vary</span>.<span class="ruby-identifier">nil?</span>
<span class="line-num">258</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-vary_header_names'>
<a name='method-i-vary_header_names'></a>
<div class='synopsis'>
<span class='name'>vary_header_names</span><span class='arguments'>()</span>

</div>
<div class='description'>

<p>An array of header names given in the vary header or an empty array when no vary header is present.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-vary_header_names-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-vary_header_names-source'>    <span class="ruby-comment"># File lib/rack/cache/response.rb</span>
<span class="line-num">262</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">vary_header_names</span>
<span class="line-num">263</span>   <span class="ruby-keyword">return</span> [] <span class="ruby-keyword">unless</span> <span class="ruby-identifier">vary</span> = <span class="ruby-identifier">headers</span>[<span class="ruby-string">&#39;vary&#39;</span>]
<span class="line-num">264</span>   <span class="ruby-identifier">vary</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp">/[\s,]+/</span>)
<span class="line-num">265</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
</div>
</div>

</div>
</div>

<div id='footer-push'></div>
</div>
<div id='footer'>
<a href="https://github.com/jeremyevans/hanna-nouveau"><strong>Hanna Nouveau</strong> RDoc template</a>
</div>
</body>
</html>
